{% extends "base.html" %}

{% block title %}SYSTEM_STATS - DOC AGENT{% endblock %}

{% block content %}
<div class="mb-8">
    <div
        class="flex flex-col md:flex-row justify-between items-center gap-4 bg-retro-card border-2 border-retro-border p-4 rounded-lg box-glow">
        <h2 class="font-arcade text-xl text-retro-primary text-glow-primary">
            <i class="fas fa-chart-bar mr-2"></i>SYSTEM_DIAGNOSTICS
        </h2>
        <p class="font-terminal text-retro-muted text-sm">DATABASE_METRICS_OVERVIEW</p>
    </div>
</div>

<!-- Summary Cards -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
    <div
        class="bg-retro-bg border-2 border-retro-primary rounded-lg p-6 text-center hover:shadow-[0_0_15px_rgba(0,255,255,0.3)] transition-all group">
        <i class="fas fa-file-alt text-3xl text-retro-primary mb-4 group-hover:animate-pulse"></i>
        <h3 class="font-arcade text-4xl text-retro-text mb-2">{{ total_docs }}</h3>
        <p class="font-terminal text-retro-muted text-xs uppercase">TOTAL_DOCUMENTS</p>
    </div>
    <div
        class="bg-retro-bg border-2 border-retro-secondary rounded-lg p-6 text-center hover:shadow-[0_0_15px_rgba(255,0,255,0.3)] transition-all group">
        <i class="fas fa-tags text-3xl text-retro-secondary mb-4 group-hover:animate-pulse"></i>
        <h3 class="font-arcade text-4xl text-retro-text mb-2">{{ categories | length }}</h3>
        <p class="font-terminal text-retro-muted text-xs uppercase">UNIQUE_CATEGORIES</p>
    </div>
    <div
        class="bg-retro-bg border-2 border-retro-accent rounded-lg p-6 text-center hover:shadow-[0_0_15px_rgba(255,255,0,0.3)] transition-all group">
        <i class="fas fa-file-code text-3xl text-retro-accent mb-4 group-hover:animate-pulse"></i>
        <h3 class="font-arcade text-4xl text-retro-text mb-2">{{ file_types | length }}</h3>
        <p class="font-terminal text-retro-muted text-xs uppercase">FILE_TYPES</p>
    </div>
    <div
        class="bg-retro-bg border-2 border-retro-success rounded-lg p-6 text-center hover:shadow-[0_0_15px_rgba(0,255,0,0.3)] transition-all group">
        <i class="fas fa-brain text-3xl text-retro-success mb-4 group-hover:animate-pulse"></i>
        <h3 class="font-arcade text-4xl text-retro-text mb-2">{{ total_docs }}</h3>
        <p class="font-terminal text-retro-muted text-xs uppercase">AI_PROCESSED</p>
    </div>
</div>

<div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
    <!-- Category Distribution -->
    <div class="bg-retro-card border-2 border-retro-border rounded-lg overflow-hidden">
        <div class="bg-retro-bg border-b-2 border-retro-border p-4">
            <h5 class="font-arcade text-sm text-retro-text">
                <i class="fas fa-tags text-retro-secondary mr-2"></i>CATEGORY_DISTRIBUTION
            </h5>
        </div>
        <div class="p-4">
            {% if categories %}
            <div class="overflow-x-auto">
                <table class="w-full font-terminal text-sm">
                    <thead>
                        <tr class="text-retro-muted border-b border-retro-border/50">
                            <th class="text-left py-2 px-3">CATEGORY</th>
                            <th class="text-right py-2 px-3">COUNT</th>
                            <th class="text-right py-2 px-3">PCT</th>
                            <th class="text-left py-2 px-3 w-1/3">LOAD</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-retro-border/30">
                        {% for category, count in categories %}
                        <tr class="hover:bg-retro-secondary/5 transition-colors">
                            <td class="py-2 px-3">
                                <span class="text-retro-secondary">{{ category | upper }}</span>
                            </td>
                            <td class="py-2 px-3 text-right text-retro-text">{{ count }}</td>
                            <td class="py-2 px-3 text-right text-retro-muted">{{ "%.1f"|format(count / total_docs * 100)
                                }}%</td>
                            <td class="py-2 px-3">
                                <div class="h-2 bg-retro-bg border border-retro-border rounded-full overflow-hidden">
                                    <div class="h-full bg-retro-secondary animate-pulse"
                                        style="width: {{ count / total_docs * 100 }}%"></div>
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <div class="text-center py-8">
                <i class="fas fa-tags text-4xl text-retro-muted mb-4"></i>
                <p class="font-terminal text-retro-muted">NO_CATEGORIES_DETECTED</p>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- File Type Distribution -->
    <div class="bg-retro-card border-2 border-retro-border rounded-lg overflow-hidden">
        <div class="bg-retro-bg border-b-2 border-retro-border p-4">
            <h5 class="font-arcade text-sm text-retro-text">
                <i class="fas fa-file-code text-retro-accent mr-2"></i>FILE_TYPE_DISTRIBUTION
            </h5>
        </div>
        <div class="p-4">
            {% if file_types %}
            <div class="overflow-x-auto">
                <table class="w-full font-terminal text-sm">
                    <thead>
                        <tr class="text-retro-muted border-b border-retro-border/50">
                            <th class="text-left py-2 px-3">TYPE</th>
                            <th class="text-right py-2 px-3">COUNT</th>
                            <th class="text-right py-2 px-3">PCT</th>
                            <th class="text-left py-2 px-3 w-1/3">LOAD</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-retro-border/30">
                        {% for file_type, count in file_types %}
                        <tr class="hover:bg-retro-accent/5 transition-colors">
                            <td class="py-2 px-3">
                                <span class="text-retro-accent">{{ file_type | upper }}</span>
                            </td>
                            <td class="py-2 px-3 text-right text-retro-text">{{ count }}</td>
                            <td class="py-2 px-3 text-right text-retro-muted">{{ "%.1f"|format(count / total_docs * 100)
                                }}%</td>
                            <td class="py-2 px-3">
                                <div class="h-2 bg-retro-bg border border-retro-border rounded-full overflow-hidden">
                                    <div class="h-full bg-retro-accent animate-pulse"
                                        style="width: {{ count / total_docs * 100 }}%"></div>
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <div class="text-center py-8">
                <i class="fas fa-file-code text-4xl text-retro-muted mb-4"></i>
                <p class="font-terminal text-retro-muted">NO_FILE_TYPES_DETECTED</p>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<!-- Recent Activity -->
<div class="mt-8">
    <div class="bg-retro-card border-2 border-retro-border rounded-lg overflow-hidden">
        <div class="bg-retro-bg border-b-2 border-retro-border p-4">
            <h5 class="font-arcade text-sm text-retro-text">
                <i class="fas fa-history text-retro-success mr-2"></i>SYSTEM_ACTIVITY_LOG
            </h5>
        </div>
        <div class="p-6">
            <div class="bg-retro-success/10 border border-retro-success/30 p-4 rounded mb-6 flex items-start gap-3">
                <i class="fas fa-info-circle text-retro-success mt-1"></i>
                <div class="font-terminal text-retro-success text-sm">
                    REAL_TIME_ANALYSIS_ACTIVE. SYSTEM_OPERATING_NORMALLY.
                    <br>
                    INITIATE_CLASSIFICATION_AGENT_TO_PROCESS_NEW_DATA.
                </div>
            </div>

            <div class="grid grid-cols-2 md:grid-cols-4 gap-6 text-center">
                <div class="p-4 border border-retro-border/50 rounded bg-retro-bg/50">
                    <h4 class="font-arcade text-2xl text-retro-primary mb-1">{{ total_docs }}</h4>
                    <small class="font-terminal text-retro-muted text-xs">DOCS_PROCESSED</small>
                </div>
                <div class="p-4 border border-retro-border/50 rounded bg-retro-bg/50">
                    <h4 class="font-arcade text-2xl text-retro-success mb-1">{{ total_docs }}</h4>
                    <small class="font-terminal text-retro-muted text-xs">EMBEDDINGS_ACTIVE</small>
                </div>
                <div class="p-4 border border-retro-border/50 rounded bg-retro-bg/50">
                    <h4 class="font-arcade text-2xl text-retro-secondary mb-1">{{ categories | length }}</h4>
                    <small class="font-terminal text-retro-muted text-xs">CATEGORIES_DETECTED</small>
                </div>
                <div class="p-4 border border-retro-border/50 rounded bg-retro-bg/50">
                    <h4 class="font-arcade text-2xl text-retro-accent mb-1">{{ file_types | length }}</h4>
                    <small class="font-terminal text-retro-muted text-xs">TYPES_SUPPORTED</small>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}