<!DOCTYPE html>
<html lang="en" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}RETRO DOC AGENT{% endblock %}</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Press+Start+2P&family=VT323&display=swap"
        rel="stylesheet">

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

    <!-- PDF.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>

    <!-- Marked.js -->
    <script src="https://cdn.jsdelivr.net/npm/marked@12.0.0/lib/marked.umd.js"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        retro: {
                            bg: 'var(--color-bg)',
                            card: 'var(--color-card)',
                            border: 'var(--color-border)',
                            primary: 'var(--color-primary)',
                            secondary: 'var(--color-secondary)',
                            accent: 'var(--color-accent)',
                            success: 'var(--color-success)',
                            danger: 'var(--color-danger)',
                            text: 'var(--color-text)',
                            muted: 'var(--color-muted)'
                        }
                    },
                    fontFamily: {
                        'arcade': ['"Press Start 2P"', 'cursive'],
                        'terminal': ['"VT323"', 'monospace'],
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'scanline': 'scanline 8s linear infinite',
                    },
                    keyframes: {
                        scanline: {
                            '0%': { transform: 'translateY(-100%)' },
                            '100%': { transform: 'translateY(100%)' }
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* Theme Definitions */
        :root,
        [data-theme="retro-game"] {
            --color-bg: #050510;
            --color-card: #0a0a1f;
            --color-border: #2a2a5a;
            --color-primary: #ff00ff;
            --color-secondary: #00ffff;
            --color-accent: #ffff00;
            --color-success: #00ff00;
            --color-danger: #ff0000;
            --color-text: #e0e0e0;
            --color-muted: #8a8a8a;
            --font-primary: 'VT323', monospace;
            --font-heading: 'Press Start 2P', cursive;
            --scanline-opacity: 1;
        }

        [data-theme="modern-dark"] {
            --color-bg: #0f172a;
            --color-card: #1e293b;
            --color-border: #334155;
            --color-primary: #3b82f6;
            --color-secondary: #8b5cf6;
            --color-accent: #f59e0b;
            --color-success: #10b981;
            --color-danger: #ef4444;
            --color-text: #f1f5f9;
            --color-muted: #94a3b8;
            --font-primary: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            --font-heading: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            --scanline-opacity: 0;
        }

        [data-theme="light"] {
            --color-bg: #ffffff;
            --color-card: #f8fafc;
            --color-border: #e2e8f0;
            --color-primary: #2563eb;
            --color-secondary: #7c3aed;
            --color-accent: #d97706;
            --color-success: #059669;
            --color-danger: #dc2626;
            --color-text: #1e293b;
            --color-muted: #64748b;
            --font-primary: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            --font-heading: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            --scanline-opacity: 0;
        }

        [data-theme="spacex-mission"] {
            --color-bg: #0a0a0a;
            --color-card: #1a1a1a;
            --color-border: #2a2a2a;
            --color-primary: #00d4ff;
            --color-secondary: #0099cc;
            --color-accent: #ffaa00;
            --color-success: #00ff88;
            --color-danger: #ff4444;
            --color-text: #e8e8e8;
            --color-muted: #888888;
            --font-primary: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            --font-heading: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            --scanline-opacity: 0;
        }

        [data-theme="default"] {
            --color-bg: #ffffff;
            --color-card: #ffffff;
            --color-border: #e2e8f0;
            --color-primary: #0f172a;
            --color-secondary: #64748b;
            --color-accent: #3b82f6;
            --color-success: #22c55e;
            --color-danger: #ef4444;
            --color-text: #0f172a;
            --color-muted: #94a3b8;
            --font-primary: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            --font-heading: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            --scanline-opacity: 0;
        }

        /* Custom Retro Effects */
        body {
            background-color: var(--color-bg);
            color: var(--color-text);
            font-family: var(--font-primary);
            font-size: 1.2rem;
            overflow-x: hidden;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        [data-theme="retro-game"] body {
            background-image:
                linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%),
                linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            background-size: 100% 2px, 3px 100%;
        }

        /* CRT Scanline Effect */
        .scanlines::before {
            content: " ";
            display: block;
            position: fixed;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            z-index: 9999;
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
        }

        /* Neon Glow Text */
        .text-glow {
            text-shadow: 0 0 5px currentColor;
        }

        .text-glow-primary {
            text-shadow: 0 0 5px #ff00ff, 0 0 10px #ff00ff;
        }

        .text-glow-secondary {
            text-shadow: 0 0 5px #00ffff, 0 0 10px #00ffff;
        }

        /* Box Glow */
        .box-glow {
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.3), inset 0 0 5px rgba(0, 255, 255, 0.1);
        }

        .box-glow-hover:hover {
            box-shadow: 0 0 15px rgba(255, 0, 255, 0.5), inset 0 0 10px rgba(255, 0, 255, 0.2);
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 12px;
            background: #050510;
        }

        ::-webkit-scrollbar-thumb {
            background: #2a2a5a;
            border: 2px solid #050510;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #ff00ff;
        }

        /* Selection */
        ::selection {
            background: #ff00ff;
            color: #000;
        }

        /* Retro Button */
        .btn-retro {
            position: relative;
            display: inline-block;
            padding: 0.5rem 1.5rem;
            background: transparent;
            border: 2px solid #00ffff;
            color: #00ffff;
            text-transform: uppercase;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.8rem;
            transition: all 0.2s;
            box-shadow: 4px 4px 0 #2a2a5a;
        }

        .btn-retro:hover {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0 #2a2a5a;
            background: rgba(0, 255, 255, 0.1);
            color: #fff;
            text-shadow: 0 0 5px #00ffff;
        }

        .btn-retro:active {
            transform: translate(4px, 4px);
            box-shadow: none;
        }

        .btn-retro-primary {
            border-color: #ff00ff;
            color: #ff00ff;
        }

        .btn-retro-primary:hover {
            background: rgba(255, 0, 255, 0.1);
            color: #fff;
            text-shadow: 0 0 5px #ff00ff;
        }

        /* Markdown Content Styling */
        .markdown-content h1,
        .markdown-content h2,
        .markdown-content h3 {
            font-family: 'Press Start 2P', cursive;
            color: #00ffff;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
        }

        .markdown-content h1 {
            font-size: 1.5rem;
            border-bottom: 2px dashed #2a2a5a;
            padding-bottom: 0.5rem;
        }

        .markdown-content h2 {
            font-size: 1.2rem;
        }

        .markdown-content p {
            margin-bottom: 1rem;
            line-height: 1.6;
        }

        .markdown-content code {
            background: #2a2a5a;
            color: #00ff00;
            padding: 0.2rem 0.4rem;
            font-family: 'VT323', monospace;
        }

        .markdown-content pre {
            background: #0a0a1f;
            border: 1px solid #2a2a5a;
            padding: 1rem;
            overflow-x: auto;
            margin-bottom: 1rem;
        }

        .markdown-content blockquote {
            border-left: 4px solid #ff00ff;
            padding-left: 1rem;
            color: #8a8a8a;
        }

        .markdown-content table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1rem;
        }

        .markdown-content th,
        .markdown-content td {
            border: 1px solid #2a2a5a;
            padding: 0.5rem;
        }

        .markdown-content th {
            background: #0a0a1f;
            color: #ff00ff;
        }

        /* SpaceX Mission Theme Specific Styles */

        /* Override body font size for SpaceX theme - use normal size, not retro large size */
        [data-theme="spacex-mission"] body {
            font-size: 1rem;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background-image:
                radial-gradient(circle at 20% 50%, rgba(0, 212, 255, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(0, 153, 204, 0.03) 0%, transparent 50%);
        }

        /* Remove scanlines for SpaceX theme */
        [data-theme="spacex-mission"] .scanlines::before {
            display: none;
        }

        /* Override all arcade fonts with modern fonts */
        [data-theme="spacex-mission"] .font-arcade,
        [data-theme="spacex-mission"] .font-terminal {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif !important;
        }

        /* Modern text styling - subtle glow instead of neon */
        [data-theme="spacex-mission"] .text-glow-primary {
            text-shadow: 0 0 10px rgba(0, 212, 255, 0.5), 0 0 20px rgba(0, 212, 255, 0.3);
        }

        [data-theme="spacex-mission"] .text-glow-secondary {
            text-shadow: 0 0 10px rgba(0, 153, 204, 0.5), 0 0 20px rgba(0, 153, 204, 0.3);
        }

        /* Subtle box glow effects */
        [data-theme="spacex-mission"] .box-glow {
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.15), inset 0 0 10px rgba(0, 212, 255, 0.05);
        }

        [data-theme="spacex-mission"] .box-glow-hover:hover {
            box-shadow: 0 0 30px rgba(0, 212, 255, 0.3), inset 0 0 15px rgba(0, 212, 255, 0.1);
            transform: translateY(-2px);
            transition: all 0.3s ease;
        }

        /* Custom scrollbar */
        [data-theme="spacex-mission"] ::-webkit-scrollbar {
            width: 12px;
            background: #0a0a0a;
        }

        [data-theme="spacex-mission"] ::-webkit-scrollbar-thumb {
            background: #2a2a2a;
            border: 2px solid #0a0a0a;
        }

        [data-theme="spacex-mission"] ::-webkit-scrollbar-thumb:hover {
            background: #00d4ff;
        }

        [data-theme="spacex-mission"] ::selection {
            background: #00d4ff;
            color: #000;
        }

        /* Modern card styling with gradient */
        [data-theme="spacex-mission"] .bg-retro-card {
            background: linear-gradient(135deg, #1a1a1a 0%, #0f0f0f 100%);
        }

        /* Subtle borders */
        [data-theme="spacex-mission"] .border-retro-border {
            border-color: rgba(0, 212, 255, 0.2);
        }

        /* Override retro button styling with modern buttons */
        [data-theme="spacex-mission"] .btn-retro,
        [data-theme="spacex-mission"] .btn-retro-primary {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif !important;
            font-size: 0.875rem;
            text-transform: none;
            border-radius: 0.375rem;
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.2);
            border: 1px solid rgba(0, 212, 255, 0.4);
        }

        [data-theme="spacex-mission"] .btn-retro:hover,
        [data-theme="spacex-mission"] .btn-retro-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 0 30px rgba(0, 212, 255, 0.4);
        }

        [data-theme="spacex-mission"] .btn-retro:active,
        [data-theme="spacex-mission"] .btn-retro-primary:active {
            transform: translateY(0);
        }

        /* Modern navigation styling */
        [data-theme="spacex-mission"] nav a,
        [data-theme="spacex-mission"] nav button,
        [data-theme="spacex-mission"] nav span {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif !important;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Override markdown content fonts */
        [data-theme="spacex-mission"] .markdown-content h1,
        [data-theme="spacex-mission"] .markdown-content h2,
        [data-theme="spacex-mission"] .markdown-content h3 {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif !important;
        }

        [data-theme="spacex-mission"] .markdown-content code {
            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace;
            background: #2a2a2a;
            color: #00ff88;
        }

        /* Default Theme Specific Styles */
        [data-theme="default"] body {
            font-size: 1rem;
            background-image: none;
            background-color: #f8fafc;
            /* Slight off-white for body background */
        }

        [data-theme="default"] .scanlines::before {
            display: none;
        }

        [data-theme="default"] .font-arcade,
        [data-theme="default"] .font-terminal {
            font-family: var(--font-primary) !important;
            letter-spacing: -0.01em;
        }

        /* Clean modern styling for Default theme */
        [data-theme="default"] .box-glow,
        [data-theme="default"] .text-glow,
        [data-theme="default"] .text-glow-primary,
        [data-theme="default"] .text-glow-secondary {
            text-shadow: none;
            box-shadow: none;
        }

        [data-theme="default"] .bg-retro-card {
            background-color: var(--color-card);
            box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
            border: 1px solid var(--color-border);
            border-radius: 0.75rem;
        }

        [data-theme="default"] .btn-retro {
            font-family: var(--font-primary);
            text-transform: none;
            box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            border-radius: 0.5rem;
            border: 1px solid var(--color-border);
            background-color: white;
            color: var(--color-text);
            font-weight: 500;
            transition: all 0.2s ease;
        }

        [data-theme="default"] .btn-retro:hover {
            transform: translateY(-1px);
            background-color: #f8fafc;
            border-color: var(--color-muted);
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            text-shadow: none;
        }

        [data-theme="default"] .btn-retro-primary {
            background-color: var(--color-primary);
            color: white;
            border: 1px solid var(--color-primary);
        }

        [data-theme="default"] .btn-retro-primary:hover {
            background-color: #1e293b;
            color: white;
            text-shadow: none;
        }

        [data-theme="default"] nav {
            background-color: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--color-border);
        }

        [data-theme="default"] nav a,
        [data-theme="default"] nav button,
        [data-theme="default"] nav span {
            font-family: var(--font-primary) !important;
            text-transform: none;
            font-weight: 500;
        }

        [data-theme="default"] .markdown-content h1,
        [data-theme="default"] .markdown-content h2,
        [data-theme="default"] .markdown-content h3 {
            font-family: var(--font-primary) !important;
            color: var(--color-primary);
            border-bottom: none;
        }

        [data-theme="default"] .markdown-content code {
            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace;
            background: #f1f5f9;
            color: #0f172a;
            border-radius: 0.25rem;
        }

        [data-theme="default"] .markdown-content pre {
            background: #f8fafc;
            border: 1px solid var(--color-border);
            border-radius: 0.5rem;
        }

        [data-theme="default"] .markdown-content blockquote {
            border-left: 4px solid var(--color-primary);
            color: var(--color-secondary);
            background: #f8fafc;
            padding: 1rem;
            border-radius: 0 0.5rem 0.5rem 0;
        }

        /* Minimalist overrides for Default theme */
        [data-theme="default"] .border-2 {
            border-width: 1px !important;
        }

        [data-theme="default"] .absolute.-inset-1.blur,
        [data-theme="default"] .absolute.-inset-0\.5.blur {
            display: none !important;
        }

        /* Icon overrides for Default theme */
        [data-theme="default"] .fa-gamepad:before {
            content: "\f1b2";
            /* fa-cube */
        }
    </style>
</head>

<body class="min-h-screen flex flex-col scanlines">

    <!-- Navbar -->
    <nav class="border-b-2 border-retro-border bg-retro-bg/90 backdrop-blur-sm sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <a href="{{ url_for('index') }}" class="flex items-center gap-3 group">
                <i
                    class="fas fa-gamepad text-2xl text-retro-primary group-hover:text-retro-secondary transition-colors animate-pulse"></i>
                <span
                    class="font-arcade text-sm md:text-base text-retro-primary group-hover:text-retro-secondary transition-colors text-glow-primary">DOC.AGENT_v2.0</span>
            </a>

            <button class="md:hidden text-retro-primary" id="mobile-menu-btn">
                <i class="fas fa-bars text-xl"></i>
            </button>

            <div class="hidden md:flex items-center gap-6" id="nav-links">
                <a href="{{ url_for('index') }}"
                    class="font-arcade text-xs text-retro-text hover:text-retro-secondary transition-colors hover:underline decoration-retro-secondary underline-offset-4">
                    <i class="fas fa-home mr-1"></i> HOME
                </a>
                <a href="{{ url_for('documents') }}"
                    class="font-arcade text-xs text-retro-text hover:text-retro-secondary transition-colors hover:underline decoration-retro-secondary underline-offset-4">
                    <i class="fas fa-file-code mr-1"></i> FILES
                </a>
                <a href="{{ url_for('stats') }}"
                    class="font-arcade text-xs text-retro-text hover:text-retro-secondary transition-colors hover:underline decoration-retro-secondary underline-offset-4">
                    <i class="fas fa-chart-pie mr-1"></i> STATS
                </a>

                <!-- Theme Switcher -->
                <div class="relative" id="theme-switcher">
                    <button id="theme-btn"
                        class="font-arcade text-xs text-retro-text hover:text-retro-primary transition-colors flex items-center gap-2">
                        <i class="fas fa-palette"></i>
                        <span id="current-theme-name">RETRO</span>
                        <i class="fas fa-chevron-down text-xs"></i>
                    </button>
                    <div id="theme-menu"
                        class="hidden absolute right-0 mt-2 w-56 bg-retro-card border-2 border-retro-border rounded shadow-lg z-50">
                        <div class="p-2 space-y-1">
                            <button onclick="setTheme('retro-game')"
                                class="theme-option w-full text-left px-3 py-2 font-arcade text-xs text-retro-text hover:bg-retro-primary/10 hover:text-retro-primary rounded flex items-center gap-3">
                                <i class="fas fa-gamepad text-retro-primary"></i>
                                <span>RETRO-GAME</span>
                            </button>
                            <button onclick="setTheme('modern-dark')"
                                class="theme-option w-full text-left px-3 py-2 font-arcade text-xs text-retro-text hover:bg-retro-primary/10 hover:text-retro-primary rounded flex items-center gap-3">
                                <i class="fas fa-moon text-retro-secondary"></i>
                                <span>MODERN-DARK</span>
                            </button>
                            <button onclick="setTheme('light')"
                                class="theme-option w-full text-left px-3 py-2 font-arcade text-xs text-retro-text hover:bg-retro-primary/10 hover:text-retro-primary rounded flex items-center gap-3">
                                <i class="fas fa-sun text-retro-accent"></i>
                                <span>LIGHT</span>
                            </button>
                            <button onclick="setTheme('spacex-mission')"
                                class="theme-option w-full text-left px-3 py-2 font-arcade text-xs text-retro-text hover:bg-retro-primary/10 hover:text-retro-primary rounded flex items-center gap-3">
                                <i class="fas fa-rocket" style="color: #00d4ff;"></i>
                                <span>SPACEX</span>
                            </button>
                            <button onclick="setTheme('default')"
                                class="theme-option w-full text-left px-3 py-2 font-arcade text-xs text-retro-text hover:bg-retro-primary/10 hover:text-retro-primary rounded flex items-center gap-3">
                                <i class="fas fa-star text-retro-text"></i>
                                <span>DEFAULT</span>
                            </button>
                        </div>
                    </div>
                </div>

                <a href="{{ url_for('refresh_data') }}" class="text-retro-success hover:text-white transition-colors"
                    title="Reload System">
                    <i class="fas fa-sync-alt fa-spin-hover"></i>
                </a>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div class="hidden md:hidden border-t border-retro-border bg-retro-card p-4" id="mobile-menu">
            <a href="{{ url_for('index') }}"
                class="block py-2 font-arcade text-xs text-retro-text hover:text-retro-secondary">HOME</a>
            <a href="{{ url_for('documents') }}"
                class="block py-2 font-arcade text-xs text-retro-text hover:text-retro-secondary">FILES</a>
            <a href="{{ url_for('stats') }}"
                class="block py-2 font-arcade text-xs text-retro-text hover:text-retro-secondary">STATS</a>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto px-4 py-8 relative">
        <!-- Grid Background Effect -->
        <div class="absolute inset-0 -z-10 opacity-10 pointer-events-none"
            style="background-image: linear-gradient(#2a2a5a 1px, transparent 1px), linear-gradient(90deg, #2a2a5a 1px, transparent 1px); background-size: 40px 40px;">
        </div>

        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class="border-t-2 border-retro-border bg-retro-card py-6 mt-8">
        <div class="container mx-auto px-4 text-center">
            <p class="font-arcade text-xs text-retro-muted">
                <i class="fas fa-robot mr-2"></i>POWERED BY AI // SYSTEM ONLINE
            </p>
            <p class="text-xs text-retro-muted mt-2 opacity-50">
                INSERT COIN TO CONTINUE...
            </p>
        </div>
    </footer>

    <script>
        // Theme Management
        const THEME_STORAGE_KEY = 'doc-agent-theme';
        const THEME_NAMES = {
            'retro-game': 'RETRO',
            'modern-dark': 'MODERN',
            'light': 'LIGHT',
            'spacex-mission': 'SPACEX',
            'default': 'DEFAULT'
        };

        function setTheme(themeName) {
            // Apply theme to HTML element
            document.documentElement.setAttribute('data-theme', themeName);

            // Save to localStorage
            localStorage.setItem(THEME_STORAGE_KEY, themeName);

            // Update button text
            const themeNameDisplay = document.getElementById('current-theme-name');
            if (themeNameDisplay) {
                themeNameDisplay.textContent = THEME_NAMES[themeName] || 'RETRO';
            }

            // Close dropdown
            const themeMenu = document.getElementById('theme-menu');
            if (themeMenu) {
                themeMenu.classList.add('hidden');
            }
        }

        function initTheme() {
            // Load saved theme or default to retro-game
            const savedTheme = localStorage.getItem(THEME_STORAGE_KEY) || 'retro-game';
            setTheme(savedTheme);
        }

        // Initialize theme on page load
        initTheme();

        // Theme dropdown toggle
        const themeBtn = document.getElementById('theme-btn');
        const themeMenu = document.getElementById('theme-menu');

        if (themeBtn && themeMenu) {
            themeBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                themeMenu.classList.toggle('hidden');
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', (e) => {
                if (!themeMenu.contains(e.target) && !themeBtn.contains(e.target)) {
                    themeMenu.classList.add('hidden');
                }
            });
        }

        // Mobile menu toggle
        const btn = document.getElementById('mobile-menu-btn');
        const menu = document.getElementById('mobile-menu');

        if (btn && menu) {
            btn.addEventListener('click', () => {
                menu.classList.toggle('hidden');
            });
        }

        // Auto-hide alerts
        setTimeout(function () {
            var alerts = document.querySelectorAll('.alert-dismissible');
            alerts.forEach(function (alert) {
                alert.style.opacity = '0';
                setTimeout(() => alert.remove(), 500);
            });
        }, 5000);
    </script>
</body>

</html>